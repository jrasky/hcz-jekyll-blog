<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> <meta name="viewport" content="width=device-width,initial-scale=1"> <link rel="shortcut icon" href="/static/img/favicon.ico"> <title>Android Performance - Jerome Rasky</title> <meta name="author" content="Jerome Rasky"> <meta name="description" content="Android Performance"> <meta name="keywords" content="Android Performance, Jerome Rasky, "> <meta content="" property="fb:app_id"> <meta content="Jerome Rasky" property="og:site_name"> <meta content="Android Performance" property="og:title"> <meta content="article" property="og:type"> <meta content="Personal Website" property="og:description"> <meta content="http://rasky.co//2017/06/09/android-performance.html" property="og:url"> <meta content="2017-06-09T00:00:00-07:00" property="article:published_time"> <meta content="http://rasky.co//about/" property="article:author"> <meta content="http://rasky.co//static/img/logo-high-resolution.png" property="og:image"> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@"> <meta name="twitter:creator" content="@"> <meta name="twitter:title" content="Android Performance"> <meta name="twitter:url" content="http://rasky.co//2017/06/09/android-performance.html"> <meta name="twitter:description" content="Personal Website"> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"> <!-- Polyfill for html imports --> <script type="text/javascript" src="/bower_components/webcomponentsjs/webcomponents-lite.js"></script> <!-- The actual html imports --> <link rel="import" href="/static/imports.html"> </head> <body class="home overflow-hidden"> <div class="header-panel shadow-z-2"> <div class="container"> <div class="row"> <div class="col-md-3 col-sm-4 col-xs-12"> <div class="row-picture"> <img id="about" class="logo-img" src="/static/img/avatar.jpg" height="75px" width="75px"> </div> <div class="row-details"> <h4 class="list-group-item-heading">Jerome Rasky</h4> <p class="list-group-item-text">Software Engineer</p> </div> <div class="navbar-header pull-right"> <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false"> <span class="sr-only">Toggle navigation</span> <i class="fa fa-2x fa-bars"></i> </button> </div> </div> <div class="col-md-9 col-sm-8 col-xs-12"> <h2 class="blog-title-pro">Android Performance</h2> <p class="info"> <span class="time">09 Jun 2017</span> </p> </div> </div> </div> </div> <div class="container main outer"> <div class="row"> <div class="col-lg-3 col-md-4 col-xs-12"> <nav class="menu"> <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1"> <ul class="list-separator nav navbar-nav well well-primary post"> <li class="col-lg-12 col-md-12 col-sm-4 col-xs-12 current-menu-item android-performance.html"><a href="/" target="_self"><i class="fa fa-home"></i> Home</a></li> <li class="col-lg-12 col-md-12 col-sm-4 col-xs-12 android-performance.html"><a href="/about/" target="_self"><i class="fa fa-comments"></i> About</a></li> <li class="col-lg-12 col-md-12 col-sm-4 col-xs-12 android-performance.html"><a href="/projects" target="_self"><i class="fa fa-desktop"></i> Projects</a></li> <li class="col-lg-12 col-md-12 col-sm-4 col-xs-12 android-performance.html"><a href="/resume.pdf" target="_blank"><i class="fa fa-graduation-cap"></i> Resume</a></li> <li class="col-lg-12 col-md-12 col-sm-4 col-xs-12 android-performance.html"><a href="https://github.com/jrasky" target="_blank"><i class="fa fa-github"></i> Github</a></li> </ul> </div> </nav> </div> <div class="col-lg-9 col-md-8 col-xs-12 full"> <div class="post-content well"> <article class="content"> <div class="post"><p>Despite their impressive hardware specifications, Android devices have an unfortunate reputation of poor performance. Frames get dropped, launching an application takes a long time, or the whole device seems to freeze. This kind of unpredictable performance isn’t great. One important factor of any platform is the programming language used. Android is based around Java, a dynamic, garbage-collected language with a hefty runtime and complex features that are tough to optimize. Android’s kernel, Linux, is designed more for servers than smartphones, and amplifies performance issues by making poor use of hardware. The story of Android performance follows the design of the platform, from the Java compiler and runtime to the Linux kernel at the base.</p> <p>The Java Virtual Machine on Android was originally designed to be simple, to conform to the resource constraints of the hardware it was running on. Google chose to create a memory-efficient bytecode and an interpreter for their JVM. Over time, hardware improved, and the JVM shifted to become a Just-In-Time compiler. JIT compilers are fast, and avoid complex optimizations. Regardless, compiler overhead meant application startup time became problem. Google tackled this by designing an ahead-of-time compiler to supplement the existing JIT design. By shifting the work of the compiler from application startup to installation, startup time improved without sacrificing performance.</p> <p>Garbage collection is about shifting the cost of memory management to reduce latency. First generation hardware limitations required choosing a design for the garbage collector that performed poorly on newer hardware. Applications often had to wait on the garbage collector, at busy times that made this pausing very noticeable. The new JIT design for the JVM improved on these glitches, introducing concurrent garbage collection and compaction. Those and other more complex strategies mean that modern applications rarely pause to wait for garbage collection.</p> <p>Between ahead-of-time compilation and improved garbage collection, the new Android JVM accomplishes the important goal of getting out of the way. There are some remaining performance issues, but most are solved. Some applications have worse performance owing to their own design, which will always be the case on any platform.</p> <p>The JVM’s design had matured, but issues around latency persisted, especially audio latency. Gaps in audio playback are even more unpleasant than dropped frames, and cause loud pops. Google’s documentation details how the default scheduler in Linux prioritizes threads that have not used processor time recently. This means that despite giving priority to UI and audio threads, other tasks might preempt user-facing ones during periods of high system usage. The solution for audio threads is real-time scheduling, so that they will always run immediately if they are ready.</p> <p>Google has recently announced that Android “O” will carry hard limits on background task execution. This will improve the situation considerably, as applications will no longer be as able to impact performance once they aren’t open. Google’s other project, Fuschia, is a complete redesign of the kernel, and represents the more nuclear approach to the performance problem in Android. It will be interesting to see what solutions are in store in the future, and what shape the Android operating system and ecosystem will take.</p> </div> </article> <hr> <div class="PageNavigation"> <a class="prev" href="/2015/08/21/why-concurrency-doesnt-matter.html">&laquo; Why Concurrency doesn't Matter</a> <a class="next" href="/2017/09/02/software-design-patterns.html">Software Design Patterns &raquo;</a> </div> </div> <div class="row"> <div class="col-md-12 col-xs-12 footer"> <footer> © 2017 Jerome Rasky and others, provided under the <a href="/LICENSE.txt" target="_blank">MIT</a> license. </footer> </div> </div> </div> <!-- end /.col-md-9 --> </div> <!-- end /.row --> </div> </body> </html> 